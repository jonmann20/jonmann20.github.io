<!DOCTYPE html><html><head><title>Dormanticide</title><style>body{background:#141a1e;margin:0}.btn-back{position:absolute;top:20px;left:20px;color:#5badd6;text-decoration:none}.btn-back:hover{color:#70b7db;text-shadow:#70b7db 0 0 6px}.canvas-wrap{width:1008px;margin:75px auto 0}</style></head><body><script>(()=>{"use strict";const t=-1;class i{constructor(){this.keysDown={},this.lastKeyDown=t;let i=t;addEventListener("keydown",(t=>{const i=this.fixKey(t.keyCode);this.keysDown[i]||(this.lastKeyDown=i,this.keysDown[i]=!0)})),addEventListener("keyup",(t=>{i=this.fixKey(t.keyCode),delete this.keysDown[i]}))}fixKey(t){return 87===t?t=38:83===t?t=40:68===t?t=39:65===t&&(t=37),t}}class e{constructor(t){this.gEngine=t}switchView(t){t.init(),this.gEngine.view=t}}const s={TACKLE:{name:"TACKLE",multiplier:1},HEAL:{name:"HEAL",multiplier:1},DRAGONS_BREATH:{name:"DRAGONS BREATH",multiplier:5}},a=class{constructor(t,i,e){this._arrow={img:">>"},this.privates={bgColor:t,dormantL:i,dormantR:e},this.init()}then(t){this.privates.callback=t}init(){this._arrow.x=43,this._arrow.y=350,this._arrow.curSlot=0,this._left={x:30,dir:0},this._fire={x:0,y:0},this._wasAttack=!1,this._wasAttackTimer=60,this._theAttack={name:"EMPTY",atk:0},this._dormantL=this.privates.dormantL,this._dormantR=this.privates.dormantR}_checkInput(){switch(game.input.lastKeyDown){case 13:return game.input.lastKeyDown=t,this._theAttack.name=this._dormantL.actions[this._arrow.curSlot].name,this._theAttack.atk=this._dormantL.atk*this._dormantL.actions[this._arrow.curSlot].multiplier/this._dormantR.def,!0;case 38:game.input.lastKeyDown=t,0!==this._arrow.curSlot&&null!==this._dormantL.actions[this._arrow.curSlot-1]&&(--this._arrow.curSlot,this._arrow.y-=30);break;case 40:game.input.lastKeyDown=t,3!==this._arrow.curSlot&&null!==this._dormantL.actions[this._arrow.curSlot+1]&&(++this._arrow.curSlot,this._arrow.y+=30)}}update(){this._wasAttack&&(this._dormantR.hp-=this._theAttack.atk/60),game.graphics.isAnimating||this._checkInput()&&(this._theAttack.name===s.TACKLE.name?this._runTackleAnimation():this._theAttack.name===s.DRAGONS_BREATH.name&&(this._wasAttack=!0)),this._dormantR.hp<=0&&(this._dormantL.xp+=25,this.privates.callback())}_runTackleAnimation(){this._left.dir=0,game.graphics.repeatAction(6,60,(()=>{0===this._left.dir&&this._left.x>60&&(this._left.dir=1),0===this._left.dir?++this._left.x:--this._left.x,this._dormantR.hp-=this._theAttack.atk/60}))}render(){if(ctx.fillStyle=this.privates.bgColor,ctx.fillRect(0,0,canvas.width,canvas.height),this._drawDormantHUD(this._dormantL,10,15,!0),this._dormantL.draw(this._left.x,90),this._drawHUD(),this._drawDormantHUD(this._dormantR,canvas.width-130,15,!1),this._dormantR.draw(770,90),this._wasAttack){const t=this._wasAttackTimer%40;t>=0&&t<10?this._fire.x=0:t>=10&&t<20?this._fire.x=5:t>=20&&t<30?this._fire.x=0:t>=30&&t<40&&(this._fire.x=-5),ctx.fillStyle="red",ctx.fillRect(870+this._fire.x,242,40,12),ctx.fillRect(880+this._fire.x,230,30,12),ctx.fillRect(880+this._fire.x,218,20,12),0==this._wasAttackTimer--&&(this._wasAttack=!1,this._wasAttackTimer=60)}}_drawDormantHUD(t,i,e,s){const a=`${t.name} L${t.lvl}`;ctx.fillStyle="#000",ctx.fillText(a,i+ctx.measureText(a).width/2,e),ctx.fillText("HP",i,e+20),ctx.strokeStyle="#000",ctx.strokeRect(i+21,e+12,100,10),ctx.fillStyle="red",ctx.fillRect(i+22,e+13,t.hp*(100/t.initHP)-1,8),s&&(ctx.fillStyle="#000",ctx.fillText("XP",i,e+40),ctx.strokeStyle="#000",ctx.strokeRect(i+21,e+32,100,10),ctx.fillStyle="#777",ctx.fillRect(i+22,e+33,t.xp*(100/t.xpNeeded)-1,8))}_drawHUD(){ctx.strokeStyle="#000",ctx.strokeRect(20,300,500,250),ctx.font="12px Arial",ctx.fillStyle="#000",ctx.fillText("ATK: "+this._dormantL.atk,460,320),ctx.fillText("DEF: "+this._dormantL.def,460,340),this._drawActionList(),this._drawActionArrow()}_drawActionList(){ctx.fillStyle="#000";for(let t=0;t<4;++t)null===this._dormantL.actions[t]?ctx.fillText("--",80,350+30*t):ctx.fillText(this._dormantL.actions[t].name,80,350+30*t)}_drawActionArrow(){ctx.fillStyle="#000",ctx.fillText(this._arrow.img,this._arrow.x,this._arrow.y)}},r=class{constructor(t,i,e,s,a,r,n){this.img=new Image,this.imgReady=!1,this.img.onload=()=>{this.imgReady=!0},this.img.src=`img/${t}`,this.name=i,this.atk=e,this.def=s,this.initHP=this.hp=a,this.actions=r,this.lvl=void 0!==n?n:1,this.xp=0,this.xpNeeded=50}draw(t,i){this.imgReady&&ctx.drawImage(this.img,t,i,this.img.width,this.img.height)}};(()=>{window.game=new class{constructor(){this.update=this.update.bind(this),this.render=this.render.bind(this),this.updateInterval=setInterval(this.update,1e3/60),this.renderRAF=requestAnimationFrame(this.render),this.onUpdateSet=!1,this.onRenderSet=!1;let t=document.createElement("a");t.href="/#games",t.innerText="Back",t.className="btn-back",document.body.appendChild(t);let s=document.createElement("div");s.className="canvas-wrap",window.canvas=document.createElement("canvas"),canvas.setAttribute("width",1008),canvas.setAttribute("height",567),s.appendChild(canvas),document.body.appendChild(s),window.ctx=canvas.getContext("2d"),this.input=new i,this.graphics=new class{constructor(){this.isAnimating=!1}repeatAction(t,i,e){this.isAnimating=!0;let s=0,a=setInterval((()=>{s++>i?(clearInterval(a),this.isAnimating=!1):e()}),t)}},this.view=new class{constructor(){this.privates={bgColor:"#ccc"},this.init()}then(t){this.privates.callback=t}init(){}update(){}render(){ctx.fillStyle=this.privates.bgColor,ctx.fillRect(0,0,canvas.width,canvas.height)}},this.utils=new e(this)}update(){this.view.update(),this.onUpdateSet&&this.onUpdate()}render(){this.renderRAF=requestAnimationFrame(this.render),this.view.render(),this.onRenderSet&&this.onRender()}onUpdate(t){this.onUpdateSet=!0,this.onUpdate=t}onRender(t){this.onRenderSet=!0,this.onRender=t}stop(){clearInterval(this.updateInterval),cancelAnimationFrame(this.renderRAF)}};let n=1,h=new class{constructor(t){this.cta="Press Enter",this.privates={title:t},this.init()}then(t){this.privates.callback=t}init(){this.title=this.privates.title}update(){13===game.input.lastKeyDown&&(game.input.lastKeyDown=t,this.privates.callback())}render(){ctx.fillStyle="#000",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.font="36px Arial",ctx.fillStyle="#fff",ctx.fillText(this.title,canvas.width/2-ctx.measureText(this.title).width/2,100),ctx.font="24px Arial",ctx.fillText(this.cta,canvas.width/2-ctx.measureText(this.cta).width/2,canvas.height/2)}}("Dormanticide");h.then((()=>{game.utils.switchView(l)}));let l=new class{constructor(){this._arrow={img:"^^"},this.privates={},this.init()}then(t){this.privates.callback=t}init(){this._arrow.x=90,this._arrow.y=canvas.height/2+70,this._arrow.slot=0}update(){13===game.input.lastKeyDown?(game.input.lastKeyDown=t,this.privates.callback()):39===game.input.lastKeyDown?(game.input.lastKeyDown=t,this._arrow.slot<7&&(this._arrow.x+=115,++this._arrow.slot)):37===game.input.lastKeyDown&&(game.input.lastKeyDown=t,this._arrow.slot>0&&(this._arrow.x-=115,--this._arrow.slot))}render(){let t,i;ctx.fillStyle="#34282c",ctx.fillRect(0,0,canvas.width,canvas.height);for(let e=0;e<8;++e)t=60+115*e,i=canvas.height/2-40,ctx.fillStyle="#fff",ctx.font="18px Arial",ctx.fillText("Level "+(e+1),t+10,i-13),ctx.fillStyle="red",ctx.fillRect(t,i,80,80);ctx.fillStyle="#fff",ctx.fillText(this._arrow.img,this._arrow.x,this._arrow.y)}};l.then((()=>{1===n?game.utils.switchView(w):game.utils.switchView(m)}));let c=[s.TACKLE,s.DRAGONS_BREATH,null,null],o=new r("malaise.png","MALAISE",12,8,27,c),d=new r("erabor.png","ERABOR",8,12,23,c),w=new a("#ddd",o,d);w.then((()=>{++n,game.utils.switchView(l)}));let m=new a("#ddd",o,d);m.then((()=>{game.utils.switchView(l)})),game.view=h})()})();</script></body></html>